---
title: "Untitled"
output: html_document
---

Import Library
```{r}
library("CubeR")
library(tibble)
library(magrittr)
library(raster)
```


Assess the complete history (all timeStamps) of one single pixel with the **pixel_history** function. If plot is TRUE the response is plotted otherwise the function will return a dataframe. One or multiple dates can be added allowing to subset the request temporally.

```{r}

ptm<-proc.time()
coverage<-getCapability()[9]
coord_sys<-coverage_get_coordsys(coverage = coverage)
bands<-coverage_get_bands(coverage = coverage)

subset<-c("620812.02", "5171499.36")

pxl_hst_5 <- suppressMessages(pixel_history(coverage, coord_sys, bands, subset, date = NULL,plot=F))
pxl_hst_5 <- pxl_hst_5 %>% as.tibble
pxl_hst_5

passed1<-proc.time()-ptm


```

The  function **geocoded_pixel_buffer()** adds a buffer (in Pixel) around a central Pixel. The outputs are either (i) a List containing the Request (main URL+ WCPS request), the bounding box, the timestamps and the Values per layer or (ii) a plot of the "Pixel Chips" from each timestamp requested.

```{r}

ptm<-proc.time()
coverage<-getCapability()[15]
bands<-coverage_get_bands(coverage = coverage)

subset<-c("620812.02", "5171499.36")

pxl_hst_5 <- suppressMessages(geocoded_pixel_buffer(coverage, band=bands[5], coords=subset,buffer=1000, date = NULL,plot = F))
str(pxl_hst_5)
pxl_hst_5 <- suppressMessages(geocoded_pixel_buffer(coverage, band=bands[5], coords=subset,buffer=1000, date = NULL,plot = T))

passed2<-proc.time()-ptm


```

CubeRs' **image_from_coverage()** function allows to extract a TIFF File from the Coverages. It offers paramters addressing the images in ways of selected bands, temporal acquisitions or spatial subsetting. Furthermore the res_eff parameter adds a possibility to resample the image.

```{r}

ptm<-proc.time()
coverage<-getCapability()[15]
times <- coverage_get_timestamps(coverage = coverage)

coords<-c("620812.02", "5171499.36") %>% as.numeric
slice_E <- as.character(c(coords[1]-5000, coords[1]+5000))
slice_N <- as.character(c(coords[2]-5000, coords[2]+5000))

img <- image_from_coverage(coverage=coverage, slice_E, slice_N, times[1], bands = bands[8])
img[[1]]

passed3<-proc.time()-ptm

```

Processing Time For the Single Functions:

```{r}
print(paste("Time Elapsed Pixel History:",passed1[3]))
print(paste("Time Elapsed Pixel Buffer:",passed2[3]))
print(paste("Time Elapsed Image:",passed3[3]))

```


